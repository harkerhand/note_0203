import matplotlib.pyplot as plt
import networkx as nx
import matplotlib

# 设置matplotlib支持中文
matplotlib.rcParams['font.sans-serif'] = ['SimHei']  # 用来正常显示中文标签
matplotlib.rcParams['axes.unicode_minus'] = False    # 用来正常显示负号

# 城市编号和名称的对应关系
cities = [
    "北京", "天津", "上海", "重庆", "石家庄", "太原", "呼和浩特", "沈阳", "长春", "哈尔滨",
    "南京", "杭州", "合肥", "福州", "南昌", "济南", "郑州", "武汉", "长沙", "广州", "南宁",
    "海口", "成都", "贵阳", "昆明", "拉萨", "西安", "兰州", "西宁", "银川", "乌鲁木齐", "香港",
    "澳门（珠海）", "台北"
]

# 各个城市的坐标 (经度，纬度) 
coordinates = {
    "北京": (116.4074, 39.9042),
    "天津": (117.1902, 39.1256),
    "上海": (121.4737, 31.2304),
    "重庆": (106.5516, 29.5630),
    "石家庄": (114.5149, 38.0428),
    "太原": (112.5495, 37.8570),
    "呼和浩特": (111.6708, 40.8183),
    "沈阳": (123.4291, 41.7968),
    "长春": (125.3245, 43.8868),
    "哈尔滨": (126.6426, 45.7567),
    "南京": (118.7969, 32.0603),
    "杭州": (120.1551, 30.2741),
    "合肥": (117.2802, 31.8610),
    "福州": (119.2965, 26.0745),
    "南昌": (115.8582, 28.6820),
    "济南": (117.0009, 36.6758),
    "郑州": (113.6249, 34.7466),
    "武汉": (114.3055, 30.5931),
    "长沙": (112.9794, 28.2134),
    "广州": (113.2644, 23.1291),
    "南宁": (108.3200, 22.8240),
    "海口": (110.3312, 20.0316),
    "成都": (104.0668, 30.5728),
    "贵阳": (106.6297, 26.6477),
    "昆明": (102.7123, 25.0380),
    "拉萨": (91.1322, 29.6600),
    "西安": (108.9398, 34.3416),
    "兰州": (103.8343, 36.0611),
    "西宁": (101.7789, 36.6171),
    "银川": (106.2782, 38.4668),
    "乌鲁木齐": (87.6177, 43.7928),
    "香港": (114.1732, 22.3200),
    "澳门（珠海）": (113.5491, 22.1987),
    "台北": (121.5654, 25.0330)
}

# 邻接表数据
adj = {
1: [(7, 459), (8, 696), (2, 117), (16, 406), (5, 281), (3, 1318)],
2: [(1, 117), (5, 292), (16, 284), (3, 1213)],
3: [(17, 1016), (16, 912), (11, 295), (2, 1213), (1, 1318), (14, 818), (12, 159)],
4: [(27, 733), (23, 304), (17, 1028), (18, 876), (28, 862), (19, 1040), (24, 347), (25, 810)],
5: [(6, 232), (17, 412), (1, 281), (2, 292), (16, 280)],
6: [(27, 571), (7, 546), (5, 232), (17, 450)],
7: [(30, 685), (27, 1117), (1, 459), (6, 546)],
8: [(1, 696), (9, 298)],
9: [(8, 298), (10, 240)],
10: [(9, 240)],
11: [(17, 690), (16, 617), (3, 295), (12, 256), (13, 157), (15, 599)],
12: [(18, 755), (11, 256), (3, 159), (13, 398), (14, 631), (15, 582)],
13: [(17, 587), (18, 355), (16, 594), (11, 157), (12, 398), (15, 453)],
14: [(3, 818), (12, 631), (15, 565), (19, 941), (20, 820)],
15: [(18, 333), (11, 599), (13, 453), (12, 582), (14, 565), (20, 882), (19, 342)],
16: [(17, 405), (1, 406), (5, 280), (2, 284), (3, 912), (11, 617), (13, 594)],
17: [(27, 523), (6, 450), (5, 412), (16, 405), (11, 690), (3, 1016), (13, 587), (18, 536), (4, 1028)],
18: [(27, 1050), (17, 536), (13, 355), (12, 755), (15, 333), (19, 362), (4, 876)],
19: [(18, 362), (4, 1040), (24, 706), (15, 342), (14, 941), (20, 707), (21, 887)],
20: [(24, 857), (15, 882), (19, 707), (14, 820), (32, 141), (33, 93), (21, 563), (22, 716)],
21: [(24, 523), (25, 720), (19, 887), (20, 563)],
22: [(20, 716)],
23: [(28, 841), (27, 658), (4, 304), (24, 642), (25, 1112), (26, 3028)],
24: [(23, 642), (4, 347), (19, 706), (20, 857), (21, 523), (25, 463)],
25: [(23, 1112), (4, 810), (24, 463), (21, 720)],
26: [(23, 3028)],
27: [(28, 568), (30, 617), (7, 1117), (6, 571), (17, 523), (18, 1050), (4, 733), (23, 658)],
28: [(31, 1786), (30, 474), (29, 188), (27, 568), (23, 841), (4, 862)],
29: [(31, 1598), (28, 188)],
30: [(28, 474), (27, 617), (7, 685)],
31: [(29, 1598), (28, 1786)],
32: [(20, 141)],
33: [(20, 93)],
}

# 创建图
G = nx.Graph()

# 添加节点
for i, city in enumerate(cities, start=1):
    G.add_node(i, label=city, pos=coordinates[city])

# 添加边
for i, neighbors in adj.items():
    for neighbor, distance in neighbors:
        G.add_edge(i, neighbor, weight=distance)

# 设置绘图参数
pos = nx.get_node_attributes(G, 'pos')
labels = nx.get_node_attributes(G, 'label')

# 绘制图形
plt.figure(figsize=(10, 10))
nx.draw(G, pos, with_labels=True, labels=labels, 
        node_size=500, 
        node_color="lightblue", 
        font_size=8, 
        font_weight="bold", 
        font_family="SimHei",  # 明确指定使用黑体
        edge_color="gray")

# 添加边的权重标签（距离）
edge_labels = nx.get_edge_attributes(G, 'weight')
nx.draw_networkx_edge_labels(G, pos, edge_labels=edge_labels, font_family="SimHei", font_size=8)

plt.title("铁路网络图", fontsize=16)
plt.savefig("railway_network.png", dpi=300)  # 保存高清图片以便检查
plt.show()
